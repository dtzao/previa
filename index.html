<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Consulta de Escala por RE</title>

<style>
body {
  background: #0f0f0f;
  color: #e0e0e0;
  font-family: "Segoe UI", Tahoma, sans-serif;
  margin: 0;
}

.container {
  max-width: 900px;
  margin: 80px auto;
  padding: 0 20px;
  text-align: center;
}

h1 {
  color: #1e88ff;
  margin-bottom: 30px;
}

input {
  width: 100%;
  padding: 14px 18px;
  font-size: 16px;
  border-radius: 10px;
  border: 1px solid #333;
  background: #1a1a1a;
  color: #fff;
}

.resultado {
  margin-top: 30px;
  padding: 22px;
  border-radius: 12px;
  font-size: 20px;
  display: none;
}

.encontrado {
  background: rgba(30,136,255,0.18);
  border: 1px solid #1e88ff;
}

.nao-encontrado {
  background: rgba(255,70,70,0.15);
  border: 1px solid #ff4d4d;
  color: #ffb3b3;
}
</style>
</head>

<body>

<div class="container">
  <h1>Consulta de Escala</h1>

  <input
    id="reInput"
    type="text"
    placeholder="Digite o RE (ex: 154.466-7)"
  >

  <div id="resultado" class="resultado"></div>
</div>

<script>
const CSV_URL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vStjOw-tr--fHNCQjTq7Ufx9uZx2IsOk19PwP7GmAY_botbjA9scRBDgFJHdzeTkbPLxFZxC-6Ddy3m/pub?gid=GID_DA_ABA_CONSULTA&single=true&output=csv";

const input = document.getElementById("reInput");
const resultado = document.getElementById("resultado");

let linhas = [];

fetch(CSV_URL)
  .then(res => res.text())
  .then(csv => {
    linhas = csv.split(/\r?\n/);
  });

input.addEventListener("input", () => {
  const reDigitado = input.value.trim();

  if (reDigitado.length < 6) {
    resultado.style.display = "none";
    return;
  }

  let encontrado = false;

  for (let i = 1; i < linhas.length; i++) { // pula cabeçalho
    const colunas = linhas[i].split(",");

    const rePlanilha = (colunas[1] || "").trim(); // coluna B
    const infoEscala = (colunas[3] || "").trim(); // coluna D

    if (rePlanilha === reDigitado) {
      resultado.className = "resultado encontrado";
      resultado.innerHTML = `<strong>Escala</strong><br>${infoEscala}`;
      resultado.style.display = "block";
      encontrado = true;
      break;
    }
  }

  if (!encontrado) {
    resultado.className = "resultado nao-encontrado";
    resultado.innerHTML =
      "RE não encontrado. Na preleção procure um superior da escala";
    resultado.style.display = "block";
  }
});
</script>

</body>
</html>
